most of the code refers to the example from internet
